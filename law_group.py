'''
@Date:19/07/22/19:28
@Author:LuLu
@Function:
    由PrisonYear（一维数组）和原始法律文书，生成y(月份）\t法律文书中“判决如下”的前面的部分\n，并分成train,test,val三个文档
    PS:原始法律文书无需去掉符号
@Design:
    #打开预处理的（删除了判决结果等信息的，每个案件之间按照换行符标识的）txt，写一个循环，按行读取文件
        对于每一行的文本：
            首先与有期徒刑月份数连接
            然后分成以下三个文件：
            count<500的：连接prisonMonth\t文本内容\n，写到文件train.txt
            count<600的：test.txt
            else:val.txt
'
'''

import os
import re

#前652个案例的有期徒刑月数
prisonMonth=[36, 24, 10, 14, 12, 12, 12, 0, 36, 36, 0, 0, 60, 0, 18, 8, 12, 0, 36, 15, 15, 0, 36, 36, 36, 12, 18, 36, 36, 6, 10, 9, 12, 9, 10, 36, 16, 0, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8, 0, 22, 12, 7, 0, 12, 0, 12, 9, 0, 12, 15, 9, 7, 0, 14, 20, 12, 14, 12, 18, 36, 18, 36, 14, 36, 36, 24, 36, 14, 12, 48, 0, 0, 0, 0, 0, 0, 43, 18, 36, 10, 10, 6, 12, 36, 1, 15, 24, 0, 12, 12, 12, 12, 14, 0, 0, 0, 0, 24, 30, 0, 12, 6, 1, 20, 12, 24, 12, 10, 12, 12, 36, 8, 18, 8, 14, 15, 14, 7, 18, 8, 12, 10, 0, 12, 0, 8, 0, 12, 10, 12, 0, 0, 12, 0, 12, 15, 36, 0, 15, 0, 12, 36, 12, 0, 14, 8, 18, 36, 12, 0, 9, 12, 12, 22, 12, 22, 12, 36, 1, 8, 20, 12, 42, 12, 54, 9, 18, 10, 12, 0, 7, 36, 12, 0, 36, 12, 12, 12, 24, 15, 16, 36, 0, 45, 36, 12, 6, 12, 10, 10, 14, 16, 18, 9, 0, 36, 19, 36, 15, 14, 12, 48, 18, 36, 10, 0, 20, 0, 0, 36, 18, 24, 14, 12, 10, 12, 0, 12, 48, 24, 24, 30, 12, 19, 36, 12, 12, 9, 12, 12, 12, 18, 7, 10, 36, 12, 12, 12, 16, 12, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 36, 12, 0, 10, 36, 12, 12, 12, 0, 9, 36, 14, 0, 0, 0, 12, 6, 36, 12, 12, 12, 36, 15, 10, 36, 12, 24, 18, 10, 12, 36, 0, 10, 14, 36, 78, 12, 12, 12, 0, 36, 10, 0, 12, 10, 0, 0, 14, 12, 12, 9, 7, 36, 1, 18, 9, 36, 36, 36, 24, 36, 30, 8, 36, 18, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 16, 15, 10, 18, 18, 36, 12, 12, 7, 24, 9, 15, 36, 24, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 48, 0, 9, 36, 0, 36, 6, 18, 12, 10, 24, 30, 18, 8, 6, 18, 10, 12, 14, 48, 9, 18, 18, 12, 12, 0, 6, 0, 0, 10, 18, 9, 6, 0, 10, 12, 0, 10, 0, 0, 0, 12, 0, 0, 0, 30, 12, 24, 36, 7, 24, 10, 9, 10, 7, 18, 9, 27, 7, 9, 16, 12, 12, 12, 36, 12, 6, 24, 6, 12, 36, 12, 9, 36, 36, 20, 9, 10, 12, 6, 48, 10, 12, 0, 36, 0, 42, 12, 0, 0, 0, 10, 12, 6, 36, 0, 0, 36, 12, 0, 12, 12, 0, 29, 0, 0, 12, 9, 12, 12, 36, 0, 12, 16, 12, 18, 34, 46, 0, 12, 36, 36, 22, 12, 60, 0, 0, 0, 0, 0, 0, 42, 0, 0, 0, 0, 12, 12, 12, 36, 36, 0, 36, 14, 7, 36, 36, 36, 9, 36, 0, 0, 0, 0, 12, 6, 6, 0, 0, 0, 0, 0, 0, 12, 0, 0, 36, 12, 14, 0, 0, 0, 13, 0, 12, 0, 12, 0, 6, 0, 18, 18, 0, 36, 1, 0, 12, 36, 12, 12, 1, 7, 10, 12, 48, 18, 18, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 14, 0, 0, 12, 12, 36, 12, 12, 12, 12, 12, 9, 18, 36, 9, 20, 6, 24, 48, 10, 9, 9, 0, 0, 0, 0, 48, 0, 12, 12, 10, 0, 14, 0, 27, 36, 0, 12, 36, 0, 0, 0, 20, 0, 24, 8, 8, 36, 24, 10, 12, 14, 6, 24, 12, 24, 0, 0, 12, 12, 24, 22, 10, 8, 9, 12, 12, 0, 0, 0, 12, 16, 24, 14, 12]


def seperate_file_in_3(dirname):
    '''
    ：Function:将一个数据集连接上判刑月数后，分成三个文件
    :dirname: 原数据文件
    :文件内容格式:  有期徒刑月份数（int)\t内容\n
    '''

    f_train = open('data/train.txt','a',encoding='utf-8')
    f_test = open('data/test.txt','a',encoding='utf-8')
    f_val = open('data/val.txt','a',encoding='utf-8')
    caseCount=0#计数，处理到第几个案件了？
    file=open(dirname)
    i=j=count=0
    for line in file:#原为694行
        #newline=str(j)+'\t'+str(prisonMonth[i])+'\t'+line#写入新文件的格式
        newline =str(prisonMonth[i]) + '\t' + line  # 写入新文件的格式
        i = i+1
        j = j+1
        if(count<500):
            f_train.write(newline)
            #print(newline)
        elif(count<600):
            f_test.write(newline)
            #print(newline)
        else:
            f_val.write(newline)
        count=count+1
        if(i==652):
            break
    f_train.close()
    f_test.close()
    f_val.close()


if __name__ == '__main__':
    seperate_file_in_3('data/data.txt')
    #这个函数把RawData.txt删除无关词，合并上有期徒刑年份后，分成三个文件:train,test,validation

